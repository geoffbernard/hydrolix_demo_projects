import requests

hostname = "dev-play.hydrolix.net"; 


url = "https://" + hostname + "/ingest/event"

print("sending to: " + url)

payload = "489434,21523,FANCY FONT HOME SWEET HOME DOORMAT,10,2022-04-06 09:43:01,5.95,13085,United Kingdom"
payload = payload + "\n" +  "489436,48173C,DOOR MAT BLACK FLOCK ,10,2009-12-01 09:06:00,5.95,13078.0,United Kingdom"


headers = {
    "x-hdx-table": "hydrolix_demo_project.commerce",
    "x-hdx-transform": "online_retail_transactions",
    "content-type": "text/csv",
    "authorization": "Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI5YWM2ZW5uZkluWFlQemF0T0dXN1RHXzRvNktnVE9abVo2S1ItX05lVnlZIn0.eyJleHAiOjE2ODA5OTc3OTYsImlhdCI6MTY4MDkxMTM5NiwianRpIjoiYjk5MTVkMGUtM2E0Yi00OWZiLTg4OGItMmUyMzM2ODRmZTU5IiwiaXNzIjoiaHR0cDovL2tleWNsb2FrOjgwODAvYXV0aC9yZWFsbXMvaHlkcm9saXgtdXNlcnMiLCJhdWQiOlsiY29uZmlnLWFwaSIsImFjY291bnQiXSwic3ViIjoiMmUxOWIwMWQtYzZkYS00NTYzLWI0YjktNmQyZTRjZDk1NWE1IiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY29uZmlnLWFwaSIsInNlc3Npb25fc3RhdGUiOiI0YzhhYjM2Zi1jYjQyLTQ4M2QtOGU3MC1mYTY3YjljZmVlMWMiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1oeWRyb2xpeC11c2VycyIsIm9mZmxpbmVfYWNjZXNzIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6ImVtYWlsIGNvbmZpZy1hcGktc2VydmljZSBwcm9maWxlIiwic2lkIjoiNGM4YWIzNmYtY2I0Mi00ODNkLThlNzAtZmE2N2I5Y2ZlZTFjIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsInByZWZlcnJlZF91c2VybmFtZSI6InNlcnZpY2VzQGh5ZHJvbGl4LmlvIiwiZW1haWwiOiJzZXJ2aWNlc0BoeWRyb2xpeC5pbyJ9.TJqX1mWzMJfqSS5WZPQltsz8Fy73_WDLTrWxfSOK3IDY8xIq6gymkl-SPALUVp48nc_nSyFbLevQ5gGXbvopvRm1lQghBkp7divNgOAQBk_NwUtbAG8HKyI3k9WfQ_vkoJXeGGgCZjaZvncVf1fL0CLLHIvjJLBk-WUdOfOqd64kpCmib9PLaMKZNm3BBnrNTMDtwWK2mL3ER9b0hj9Oq9pZk2QEHPlfnYCGqk7T1k0pN-L3W1QjN5v-nrbprsBLg4n8k_kRAWiURPKAqYgms0SkmhH_l0ZLfcS8Btd_cLbQptI3rGFsV9kduAKUV74t_XlQv5T1ViodJrOFNwFqQg"
}

response = requests.post(url, data=payload, headers=headers)

print(response.text)
